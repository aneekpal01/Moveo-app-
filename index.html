<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOVEO ‚Äî Ride Hailing App</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='22' fill='%230A1AFF'/><text x='50' y='68' font-size='60' text-anchor='middle' fill='white' font-weight='bold'>M</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  :root {
    --primary: #0A1AFF;
    --primary-dark: #0815CC;
    --cyan: #00E5FF;
    --dark: #0B0B0B;
    --dark-bg: #080C24;
    --card-bg: #0E1438;
    --card-bg2: #131A4A;
    --white: #FFFFFF;
    --gray: #8892B0;
    --gray-light: #CCD6F6;
    --success: #00E676;
    --warning: #FFD600;
    --danger: #FF1744;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Poppins', 'Segoe UI', sans-serif;
    background: var(--dark-bg);
    color: var(--white);
    min-height: 100vh;
    overflow-x: hidden;
  }
  button { font-family: inherit; }
  input { font-family: inherit; }

  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(0,229,255,0.2); border-radius: 4px; }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.05); }
  }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }
  @keyframes slideInLeft {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
  }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes countDown {
    from { stroke-dashoffset: 0; }
    to { stroke-dashoffset: 283; }
  }
  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .app-container { max-width: 440px; margin: 0 auto; min-height: 100vh; position: relative; }
  .app-container.admin { max-width: 820px; }

  .btn {
    border: none; cursor: pointer; border-radius: 14px; font-weight: 700;
    font-size: 15px; padding: 16px; width: 100%; display: flex;
    align-items: center; justify-content: center; gap: 8px; transition: all 0.2s;
  }
  .btn-primary { background: linear-gradient(135deg, var(--primary), var(--cyan)); color: white; }
  .btn-success { background: linear-gradient(135deg, var(--success), #00C853); color: white; }
  .btn-danger-outline { background: rgba(255,23,68,0.12); border: 2px solid var(--danger); color: var(--danger); }
  .btn:hover { transform: translateY(-1px); filter: brightness(1.1); }
  .btn-sm { padding: 10px 16px; font-size: 13px; width: auto; border-radius: 10px; }
  .btn-icon {
    width: 40px; height: 40px; border-radius: 10px; border: none; cursor: pointer;
    display: flex; align-items: center; justify-content: center; background: rgba(0,229,255,0.08);
  }

  .card {
    background: var(--card-bg); border-radius: 16px; padding: 18px;
    border: 1px solid rgba(0,229,255,0.06); margin-bottom: 12px;
  }

  .badge {
    padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: 600;
    display: inline-flex; align-items: center; gap: 4px;
  }
  .badge::before {
    content: ''; width: 6px; height: 6px; border-radius: 50%; display: inline-block;
  }
  .badge-online { background: rgba(0,230,118,0.13); color: var(--success); }
  .badge-online::before { background: var(--success); }
  .badge-offline { background: rgba(255,23,68,0.13); color: var(--danger); }
  .badge-offline::before { background: var(--danger); }
  .badge-onride { background: rgba(255,214,0,0.13); color: var(--warning); }
  .badge-onride::before { background: var(--warning); }
  .badge-completed { background: rgba(0,230,118,0.13); color: var(--success); }
  .badge-completed::before { background: var(--success); }
  .badge-inprogress { background: rgba(0,229,255,0.13); color: var(--cyan); }
  .badge-inprogress::before { background: var(--cyan); }
  .badge-cancelled { background: rgba(255,23,68,0.13); color: var(--danger); }
  .badge-cancelled::before { background: var(--danger); }
  .badge-pending { background: rgba(255,214,0,0.13); color: var(--warning); }
  .badge-pending::before { background: var(--warning); }
  .stat-card {
    background: var(--card-bg); border-radius: 16px; padding: 20px 22px;
    position: relative; overflow: hidden;
  }
  .stat-card .bg-circle {
    position: absolute; top: -20px; right: -20px; width: 80px; height: 80px;
    border-radius: 50%; opacity: 0.08;
  }
  .stat-card .stat-icon {
    width: 38px; height: 38px; border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
  }
  .stat-card .stat-value { font-size: 26px; font-weight: 700; margin-top: 12px; }
  .stat-card .stat-sub { font-size: 12px; color: var(--gray); margin-top: 4px; }
  .stat-card .stat-trend { font-size: 11px; margin-top: 4px; font-weight: 600; }

  .sim-map {
    background: #0a1628; border-radius: 16px; position: relative;
    overflow: hidden; border: 1px solid rgba(0,229,255,0.06);
  }
  .sim-map .grid-h, .sim-map .grid-v {
    position: absolute; background: rgba(0,229,255,0.04);
  }
  .sim-map .grid-h { left: 0; right: 0; height: 1px; }
  .sim-map .grid-v { top: 0; bottom: 0; width: 1px; }
  .sim-map .road-h { position: absolute; left: 0; right: 0; background: rgba(136,146,176,0.15); }
  .sim-map .road-v { position: absolute; top: 0; bottom: 0; background: rgba(136,146,176,0.15); }
  .sim-map .map-label {
    position: absolute; bottom: 10px; left: 12px;
    background: rgba(8,12,36,0.8); backdrop-filter: blur(8px);
    padding: 6px 12px; border-radius: 8px; font-size: 11px; color: var(--gray);
    display: flex; align-items: center; gap: 6px;
  }
  .sim-map .marker {
    position: absolute; display: flex; flex-direction: column; align-items: center;
  }
  .sim-map .marker-dot {
    width: 32px; height: 32px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center; font-size: 14px;
  }
  .sim-map .marker-label { font-size: 10px; margin-top: 4px; font-weight: 600; white-space: nowrap; }
  .sim-map .driver-marker {
    position: absolute; transition: all 1s ease;
  }
  .sim-map .driver-dot {
    width: 36px; height: 36px; border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--cyan));
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 0 25px rgba(0,229,255,0.35); animation: pulse 2s infinite;
    font-size: 16px;
  }

  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
  .flex-center { display: flex; align-items: center; justify-content: center; }
  .flex-between { display: flex; align-items: center; justify-content: space-between; }


  .progress-bar { height: 6px; background: var(--card-bg2); border-radius: 3px; overflow: hidden; }
  .progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s; }

 
  .input-field {
    width: 100%; padding: 10px 14px; background: var(--card-bg2);
    border: 1px solid rgba(0,229,255,0.08); border-radius: 10px;
    color: var(--white); font-size: 13px; outline: none;
  }
  .input-field::placeholder { color: var(--gray); }
  .input-field:focus { border-color: rgba(0,229,255,0.3); }


  .menu-overlay {
    position: fixed; inset: 0; z-index: 100; display: flex;
  }
  .menu-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.7); }
  .menu-panel {
    position: relative; z-index: 1; width: 270px; background: var(--dark-bg);
    padding: 24px; height: 100%; animation: slideInLeft 0.3s ease;
    overflow-y: auto;
  }
  .menu-item {
    display: flex; align-items: center; gap: 14px; width: 100%;
    padding: 14px 0; border: none; background: none; cursor: pointer;
    border-bottom: 1px solid rgba(136,146,176,0.08); color: var(--gray-light); font-size: 14px;
  }

 
  .suggestions {
    position: absolute; top: 100%; left: 0; right: 0;
    background: var(--card-bg2); border-radius: 0 0 10px 10px;
    z-index: 10; border: 1px solid rgba(0,229,255,0.08); border-top: none;
  }
  .suggestion-item {
    display: flex; align-items: center; gap: 8px; width: 100%;
    padding: 10px 14px; background: none; border: none;
    border-bottom: 1px solid rgba(136,146,176,0.05); cursor: pointer; text-align: left;
    color: var(--gray-light); font-size: 12px;
  }
  .suggestion-item:hover { background: rgba(0,229,255,0.05); }

  .vehicle-option {
    width: 100%; display: flex; align-items: center; gap: 14px;
    padding: 14px; margin-bottom: 8px; border-radius: 14px; cursor: pointer;
    background: var(--card-bg); border: 1px solid rgba(0,229,255,0.06);
    text-align: left; transition: all 0.2s;
  }
  .vehicle-option.selected {
    background: rgba(0,229,255,0.08); border: 2px solid var(--cyan);
  }
  .vehicle-option:hover { border-color: rgba(0,229,255,0.3); }

 
  .star-btn { background: none; border: none; cursor: pointer; transition: transform 0.2s; padding: 2px; }
  .star-btn.active { transform: scale(1.2); }

 
  .tab-btn {
    display: flex; align-items: center; gap: 6px; padding: 8px 14px;
    border-radius: 10px; border: none; cursor: pointer; white-space: nowrap;
    font-size: 12px; font-weight: 400; background: transparent; color: var(--gray);
    transition: all 0.2s;
  }
  .tab-btn.active { background: rgba(0,229,255,0.1); color: var(--cyan); font-weight: 600; }


  .ride-card {
    background: var(--card-bg); border-radius: 14px; padding: 14px;
    margin-bottom: 10px; border: 1px solid rgba(0,229,255,0.04);
  }

 
  .driver-item {
    width: 100%; display: flex; align-items: center; gap: 12px;
    padding: 14px; margin-bottom: 8px; border-radius: 14px; cursor: pointer;
    background: var(--card-bg); border: 1px solid rgba(0,229,255,0.04);
    text-align: left; transition: all 0.2s;
  }
  .driver-item:hover { border-color: rgba(0,229,255,0.2); }


  .pay-opt {
    flex: 1; padding: 8px 0; border-radius: 10px; cursor: pointer;
    font-size: 12px; color: var(--white); text-align: center;
    background: var(--card-bg2); border: 1px solid rgba(136,146,176,0.1);
    transition: all 0.2s;
  }
  .pay-opt.active { background: rgba(0,229,255,0.08); border: 2px solid var(--cyan); }

  
  .filter-btn {
    padding: 6px 12px; border-radius: 8px; cursor: pointer; font-size: 11px;
    text-transform: capitalize; background: transparent;
    border: 1px solid rgba(0,229,255,0.08); color: var(--gray);
    transition: all 0.2s;
  }
  .filter-btn.active { background: rgba(0,229,255,0.1); color: var(--cyan); }

  
  .surge-btn {
    flex: 1; padding: 10px 0; border-radius: 10px; cursor: pointer;
    font-size: 13px; font-weight: 600;
    background: var(--card-bg2); border: 1px solid rgba(136,146,176,0.08);
    color: var(--gray); transition: all 0.2s;
  }
  .surge-btn.active { background: rgba(255,214,0,0.12); border: 2px solid var(--warning); color: var(--warning); }

 
  .landing {
    min-height: 100vh; display: flex; flex-direction: column;
    align-items: center; justify-content: center; padding: 24px;
    position: relative; overflow: hidden;
  }
  .landing .bg-orb1 {
    position: absolute; top: -100px; right: -100px; width: 400px; height: 400px;
    border-radius: 50%; background: radial-gradient(circle, rgba(10,26,255,0.1) 0%, transparent 70%);
  }
  .landing .bg-orb2 {
    position: absolute; bottom: -100px; left: -100px; width: 300px; height: 300px;
    border-radius: 50%; background: radial-gradient(circle, rgba(0,229,255,0.06) 0%, transparent 70%);
  }
  .landing-card {
    width: 100%; max-width: 340px; padding: 18px 20px; border-radius: 16px;
    background: var(--card-bg); cursor: pointer; display: flex;
    align-items: center; gap: 16px; text-align: left; transition: all 0.3s;
    border: 1px solid transparent; margin-bottom: 14px;
  }
  .landing-card:hover { transform: translateX(4px); }

  
  .switch-btn {
    position: fixed; top: 12px; left: 12px; z-index: 90;
    background: rgba(14,20,56,0.9); backdrop-filter: blur(10px);
    border: 1px solid rgba(0,229,255,0.15); border-radius: 10px;
    padding: 6px 12px; cursor: pointer; display: flex; align-items: center; gap: 6px;
    color: var(--cyan); font-size: 11px; font-weight: 600;
  }

  .hidden { display: none !important; }


  .chart-container { position: relative; width: 100%; }
</style>
</head>
<body>


<div id="landing" class="landing">
  <div class="bg-orb1"></div>
  <div class="bg-orb2"></div>

  <div style="animation: float 3s ease-in-out infinite; margin-bottom: 32px;">
    <div style="display:flex;align-items:center;gap:12px;">
      <div style="width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;box-shadow:0 4px 24px rgba(0,229,255,0.2);">
        <svg width="42" height="42" viewBox="0 0 40 40" fill="none"><path d="M5 32L13 8L20 22L27 8L35 32" stroke="white" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M20 22L20 32" stroke="#00E5FF" stroke-width="2.5" stroke-linecap="round"/><circle cx="20" cy="7" r="2" fill="#00E5FF"/></svg>
      </div>
      <span style="font-size:35px;font-weight:800;letter-spacing:3px;color:white;">MOVEO</span>
    </div>
  </div>

  <p style="color:var(--gray);font-size:16px;margin-bottom:48px;text-align:center;max-width:320px;">
    Delhi's smartest ride-hailing platform. Fast, safe, affordable.
  </p>

  <div style="display:flex;flex-direction:column;width:100%;max-width:340px;">
    <div class="landing-card" onclick="openApp('rider')" style="animation:fadeUp 0.5s ease 0s both;border-color:rgba(0,229,255,0.12);">
      <span style="font-size:32px;"></span>
      <div style="flex:1;"><div style="font-weight:700;font-size:16px;">Rider App</div><div style="color:var(--gray);font-size:12px;">Book rides across Delhi</div></div>
      <span style="color:var(--cyan);font-size:20px;">‚Ä∫</span>
    </div>
    <div class="landing-card" onclick="openApp('driver')" style="animation:fadeUp 0.5s ease 0.15s both;border-color:rgba(0,230,118,0.12);">
      <span style="font-size:32px;"></span>
      <div style="flex:1;"><div style="font-weight:700;font-size:16px;">Driver App</div><div style="color:var(--gray);font-size:12px;">Accept rides & earn money</div></div>
      <span style="color:var(--success);font-size:20px;">‚Ä∫</span>
    </div>
    <div class="landing-card" onclick="openApp('admin')" style="animation:fadeUp 0.5s ease 0.3s both;border-color:rgba(255,23,68,0.12);">
      <span style="font-size:32px;"></span>
      <div style="flex:1;"><div style="font-weight:700;font-size:16px;">Admin Dashboard</div><div style="color:var(--gray);font-size:12px;">Manage everything</div></div>
      <span style="color:var(--danger);font-size:20px;">‚Ä∫</span>
    </div>
  </div>

  <div style="margin-top:48px;display:flex;gap:20px;color:var(--gray);font-size:11px;">
    <span> Delhi NCR</span><span> Secure</span><span></span> Real-time</span>
  </div>
</div>


<div id="rider-app" class="app-container hidden">
  <button class="switch-btn" onclick="openApp('landing')">‚Üê Switch App</button>

 
  <div id="rider-menu" class="menu-overlay hidden">
    <div class="menu-backdrop" onclick="toggleMenu(false)"></div>
    <div class="menu-panel">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:30px;">
        <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:20px;">üë§</div>
        <div><div style="font-weight:600;font-size:15px;">ANEEK</div><div style="color:var(--gray);font-size:12px;">+91 99999 99999</div></div>
      </div>
      <button class="menu-item" onclick="riderGo('home');toggleMenu(false);"> &nbsp; Home</button>
      <button class="menu-item" onclick="showRideHistory();toggleMenu(false);"> &nbsp; Ride History</button>
      <button class="menu-item"> &nbsp; Wallet: ‚Çπ2,450</button>
      <button class="menu-item"> &nbsp; Payment Methods</button>
      <button class="menu-item"> &nbsp; Rewards</button>
      <button class="menu-item"> &nbsp; Settings</button>
      <button class="menu-item"> &nbsp; Safety</button>
    </div>
  </div>

 
  <div style="padding:16px 20px;display:flex;justify-content:space-between;align-items:center;">
    <button class="btn-icon" onclick="toggleMenu(true)">‚ò∞</button>
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="width:30px;height:30px;border-radius:7px;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;">
        <svg width="20" height="20" viewBox="0 0 40 40" fill="none"><path d="M5 32L13 8L20 22L27 8L35 32" stroke="white" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <span style="font-size:16px;font-weight:800;letter-spacing:2px;">MOVEO</span>
    </div>
    <button class="btn-icon" style="position:relative;"><span style="position:absolute;top:6px;right:6px;width:8px;height:8px;border-radius:50%;background:var(--danger);"></span></button>
  </div>

  <div style="padding:0 20px 20px;" id="rider-content"></div>
</div>


<div id="driver-app" class="app-container hidden">
  <button class="switch-btn" onclick="openApp('landing')">‚Üê Switch App</button>
  <div style="padding:20px;" id="driver-content"></div>
</div>


<div id="admin-app" class="app-container admin hidden">
  <button class="switch-btn" onclick="openApp('landing')">‚Üê Switch App</button>

  <div style="padding:16px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(0,229,255,0.06);">
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="width:28px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;">
        <svg width="18" height="18" viewBox="0 0 40 40" fill="none"><path d="M5 32L13 8L20 22L27 8L35 32" stroke="white" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <span style="font-size:15px;font-weight:800;letter-spacing:2px;">MOVEO</span>
    </div>
    <div style="display:flex;align-items:center;gap:8px;">
      <span style="color:var(--gray);font-size:12px;">Admin Panel</span>
      <div style="width:34px;height:34px;border-radius:8px;background:rgba(255,23,68,0.12);display:flex;align-items:center;justify-content:center;">üõ°Ô∏è</div>
    </div>
  </div>
  
  <div style="display:flex;gap:2px;padding:10px 16px;overflow-x:auto;" id="admin-tabs"></div>
  <div style="padding:12px 16px;" id="admin-content"></div>
</div>

<script>
=
const VEHICLES = [
  { id:"bike", name:"Bike", icon:"üèçÔ∏è", rate:7, base:25, eta:"2 min", desc:"Quick & affordable" },
  { id:"mini", name:"Mini", icon:"üöó", rate:12, base:40, eta:"4 min", desc:"Compact sedan" },
  { id:"sedan", name:"Sedan", icon:"üöò", rate:16, base:50, eta:"5 min", desc:"Comfortable ride" },
  { id:"suv", name:"SUV", icon:"üöô", rate:22, base:80, eta:"7 min", desc:"Spacious & premium" },
];

const DELHI_PLACES = [
  "Connaught Place","India Gate","Hauz Khas","Saket","Lajpat Nagar",
  "Karol Bagh","Dwarka Sec-21","Rohini Sec-3","Vasant Kunj","Nehru Place",
  "Rajouri Garden","Chandni Chowk","Preet Vihar","Janakpuri","Greater Kailash"
];

const MOCK_DRIVERS = [
  { id:1, name:"Rajesh Kumar", phone:"+91 98765 43210", vehicle:"Swift Dzire", plate:"DL 01 AB 1234", rating:4.8, rides:1247, status:"online", verified:true, earnings:32500 },
  { id:2, name:"Amit Singh", phone:"+91 87654 32109", vehicle:"WagonR", plate:"DL 02 CD 5678", rating:4.6, rides:892, status:"on_ride", verified:true, earnings:28700 },
  { id:3, name:"Suresh Yadav", phone:"+91 76543 21098", vehicle:"Alto 800", plate:"DL 03 EF 9012", rating:4.3, rides:456, status:"offline", verified:true, earnings:15200 },
  { id:4, name:"Vikram Sharma", phone:"+91 65432 10987", vehicle:"Ertiga", plate:"DL 04 GH 3456", rating:4.9, rides:2103, status:"online", verified:true, earnings:54800 },
  { id:5, name:"Deepak Verma", phone:"+91 54321 09876", vehicle:"Honda Activa", plate:"DL 05 IJ 7890", rating:4.1, rides:234, status:"offline", verified:false, earnings:8900 },
  { id:6, name:"Manoj Tiwari", phone:"+91 43210 98765", vehicle:"Creta", plate:"DL 06 KL 2345", rating:4.7, rides:1567, status:"online", verified:true, earnings:41200 },
];

const MOCK_RIDES = [
  { id:"MV-1001", rider:"Ananya S.", driver:"Rajesh Kumar", from:"Connaught Place", to:"Hauz Khas", fare:245, status:"completed", time:"10:34 AM", vehicle:"Sedan", distance:"8.2 km" },
  { id:"MV-1002", rider:"Priya M.", driver:"Amit Singh", from:"Saket", to:"India Gate", fare:180, status:"in_progress", time:"11:02 AM", vehicle:"Mini", distance:"6.1 km" },
  { id:"MV-1003", rider:"Rohit K.", driver:"Vikram Sharma", from:"Dwarka", to:"Nehru Place", fare:420, status:"completed", time:"09:15 AM", vehicle:"SUV", distance:"18.5 km" },
  { id:"MV-1004", rider:"Sneha L.", driver:null, from:"Rohini", to:"Rajouri Garden", fare:110, status:"cancelled", time:"09:45 AM", vehicle:"Bike", distance:"4.3 km" },
  { id:"MV-1005", rider:"Karan J.", driver:"Manoj Tiwari", from:"Vasant Kunj", to:"Chandni Chowk", fare:380, status:"completed", time:"08:20 AM", vehicle:"Sedan", distance:"15.8 km" },
];

const RIDE_HISTORY = [
  { from:"Connaught Place", to:"Hauz Khas", fare:245, date:"Today", rating:5, driver:"Rajesh K." },
  { from:"Saket", to:"India Gate", fare:180, date:"Yesterday", rating:4, driver:"Amit S." },
  { from:"Dwarka", to:"Nehru Place", fare:420, date:"2 days ago", rating:5, driver:"Vikram S." },
];

const revenueData = {
  labels: ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
  revenue: [45000,52000,48000,61000,73000,82000,67000],
  rides: [320,380,350,420,510,580,460],
};


let state = {
  rider: { step:"home", pickup:"", drop:"", selectedVehicle:null, driverPos:0, rating:0, payment:"cash" },
  driver: { step:"home", isOnline:false, timer:15, tripProgress:0 },
  admin: { tab:"overview", selectedDriver:null, pricing:{ baseFare:40, perKm:12, perMin:2, surge:1.0 } },
};

let intervals = {};


function badge(status) {
  const map = { online:"Online", offline:"Offline", on_ride:"On Ride", completed:"Completed", in_progress:"In Progress", cancelled:"Cancelled", pending:"Pending" };
  const cls = status.replace("_","");
  return `<span class="badge badge-${cls}">${map[status]||status}</span>`;
}

function stars(n, size=12) {
  return Array.from({length:5}, (_,i) =>
    `<span style="color:${i<n?'var(--warning)':'var(--gray)'};font-size:${size}px;">${i<n?'‚òÖ':'‚òÜ'}</span>`
  ).join('');
}

function mapHTML(h=280, pickup=null, drop=null, showDriver=false, driverPos=30) {
  let grids = '';
  for(let i=1;i<=10;i++) grids += `<div class="grid-h" style="top:${i*9}%"></div>`;
  for(let i=1;i<=14;i++) grids += `<div class="grid-v" style="left:${i*7}%"></div>`;

  let markers = '';
  if(pickup) markers += `<div class="marker" style="left:65px;top:${h*0.59}px;"><div class="marker-dot" style="background:var(--success);box-shadow:0 0 20px rgba(0,230,118,0.3);">üìç</div><span class="marker-label" style="color:var(--success);">${pickup}</span></div>`;
  if(drop) markers += `<div class="marker" style="right:40px;top:${h*0.17}px;"><div class="marker-dot" style="background:var(--danger);box-shadow:0 0 20px rgba(255,23,68,0.3);">üéØ</div><span class="marker-label" style="color:var(--danger);">${drop}</span></div>`;
  if(showDriver) markers += `<div class="driver-marker" id="driver-marker" style="left:${20+driverPos*0.5}%;top:${55-driverPos*0.2}%;"><div class="driver-dot">üöó</div></div>`;

  return `<div class="sim-map" style="height:${h}px;">
    ${grids}
    <div class="road-h" style="top:40%;height:3px;"></div>
    <div class="road-h" style="top:65%;height:2px;"></div>
    <div class="road-v" style="left:30%;width:3px;"></div>
    <div class="road-v" style="left:70%;width:2px;"></div>
    <svg style="position:absolute;inset:0;width:100%;height:100%;"><path d="M 80 ${h*0.64} Q 150 ${h*0.36} 200 ${h*0.43} T 320 ${h*0.29}" stroke="var(--cyan)" stroke-width="3" fill="none" stroke-dasharray="8 4" opacity="0.6"/></svg>
    ${markers}
    <div class="map-label"> Delhi NCR ‚Äî Live Map</div>
  </div>`;
}

function statCard(icon, label, value, color='var(--cyan)', trend=null) {
  let trendHTML = '';
  if(trend !== null) trendHTML = `<div class="stat-trend" style="color:${trend>0?'var(--success)':'var(--danger)'};">${trend>0?'‚Üë':'‚Üì'} ${Math.abs(trend)}% vs last week</div>`;
  return `<div class="stat-card">
    <div class="bg-circle" style="background:${color};"></div>
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:4px;">
      <div class="stat-icon" style="background:${color}18;">${icon}</div>
      <span style="color:var(--gray);font-size:13px;">${label}</span>
    </div>
    <div class="stat-value">${value}</div>
    ${trendHTML}
  </div>`;
}


function openApp(app) {
  clearAllIntervals();
  document.querySelectorAll('#landing, #rider-app, #driver-app, #admin-app').forEach(el => el.classList.add('hidden'));
  if(app === 'landing') { document.getElementById('landing').classList.remove('hidden'); return; }
  document.getElementById(app+'-app').classList.remove('hidden');
  if(app === 'rider') renderRider();
  if(app === 'driver') renderDriver();
  if(app === 'admin') renderAdmin();
}

function clearAllIntervals() {
  Object.values(intervals).forEach(id => clearInterval(id));
  intervals = {};
}


function toggleMenu(show) {
  document.getElementById('rider-menu').classList.toggle('hidden', !show);
}

function riderGo(step) {
  clearAllIntervals();
  state.rider.step = step;
  renderRider();
}

function showRideHistory() {
  const c = document.getElementById('rider-content');
  let html = `<div style="display:flex;align-items:center;gap:12px;margin-bottom:24px;">
    <button class="btn-icon" onclick="riderGo('home')">‚Üê</button>
    <span style="font-size:20px;font-weight:700;">Ride History</span>
  </div>`;
  RIDE_HISTORY.forEach(r => {
    html += `<div class="card">
      <div class="flex-between" style="margin-bottom:10px;"><span style="color:var(--gray);font-size:12px;">${r.date}</span><span style="color:var(--success);font-weight:700;">‚Çπ${r.fare}</span></div>
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;"><span style="color:var(--success);font-size:12px;">üìç</span><span style="font-size:13px;">${r.from}</span></div>
      <div style="width:1px;height:12px;background:var(--gray);margin-left:6px;opacity:0.3;"></div>
      <div style="display:flex;align-items:center;gap:8px;"><span style="color:var(--danger);font-size:12px;">üéØ</span><span style="font-size:13px;">${r.to}</span></div>
      <div class="flex-between" style="margin-top:10px;padding-top:10px;border-top:1px solid rgba(136,146,176,0.1);">
        <span style="color:var(--gray);font-size:12px;">Driver: ${r.driver}</span>
        <div>${stars(r.rating)}</div>
      </div>
    </div>`;
  });
  c.innerHTML = html;
}

function renderRider() {
  const c = document.getElementById('rider-content');
  const s = state.rider;
  const distance = (s.pickup && s.drop) ? (Math.random()*15+3).toFixed(1) : 0;
  const fare = s.selectedVehicle ? Math.round(s.selectedVehicle.base + s.selectedVehicle.rate * distance) : 0;

  
  s._distance = distance;
  s._fare = fare;

  let html = '';

  
  if(s.step === 'home') {
    html = `
      <div style="margin-bottom:20px;">
        <h2 style="font-size:24px;font-weight:700;margin-bottom:4px;">Where to? </h2>
        <p style="color:var(--gray);font-size:13px;">Book a ride across Delhi</p>
      </div>
      ${mapHTML(200)}
      <div style="display:flex;gap:10px;margin:20px 0;overflow-x:auto;padding-bottom:4px;">
        ${[" Home"," Office"," Market"," Hospital"].map(q =>
          `<button style="background:var(--card-bg2);border:1px solid rgba(0,229,255,0.08);border-radius:12px;padding:10px 16px;color:var(--gray-light);font-size:13px;cursor:pointer;white-space:nowrap;flex-shrink:0;" onclick="state.rider.pickup='My Location';state.rider.drop='${q.split(' ')[1]}';riderGo('booking');">${q}</button>`
        ).join('')}
      </div>
      <button onclick="riderGo('booking')" style="width:100%;padding:16px 18px;background:var(--card-bg);border:1px solid rgba(0,229,255,0.12);border-radius:14px;cursor:pointer;display:flex;align-items:center;gap:12px;text-align:left;">
        <span style="color:var(--gray);font-size:16px;"></span>
        <span style="color:var(--gray);font-size:14px;">Search destination...</span>
      </button>
      <div style="margin-top:24px;">
        <div class="flex-between" style="margin-bottom:14px;">
          <span style="font-weight:600;font-size:16px;">Recent Rides</span>
          <button style="background:none;border:none;color:var(--cyan);font-size:13px;cursor:pointer;" onclick="showRideHistory()">View All ‚Üí</button>
        </div>
        ${RIDE_HISTORY.slice(0,2).map(r => `
          <button onclick="state.rider.pickup='${r.from}';state.rider.drop='${r.to}';riderGo('booking');" style="width:100%;background:var(--card-bg);border:1px solid rgba(0,229,255,0.04);border-radius:12px;padding:14px;margin-bottom:8px;cursor:pointer;display:flex;align-items:center;gap:12px;text-align:left;">
            <span style="color:var(--gray);"></span>
            <div style="flex:1;"><div style="font-size:13px;">${r.from} ‚Üí ${r.to}</div><div style="color:var(--gray);font-size:11px;">${r.date} ¬∑ ‚Çπ${r.fare}</div></div>
            <span style="color:var(--gray);">‚Ä∫</span>
          </button>
        `).join('')}
      </div>`;
  }


  else if(s.step === 'booking') {
    html = `
      <button class="btn-icon" onclick="riderGo('home')" style="margin-bottom:16px;">‚Üê</button>
      <div class="card" style="padding:18px;">
        <div style="display:flex;align-items:center;gap:12px;">
          <div style="display:flex;flex-direction:column;align-items:center;">
            <span style="color:var(--success);font-size:14px;">‚óè</span>
            <div style="width:2px;height:30px;background:rgba(136,146,176,0.15);margin:2px 0;"></div>
            <span style="color:var(--danger);font-size:14px;">‚óé</span>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;gap:10px;">
            <div style="position:relative;">
              <input class="input-field" id="pickup-input" placeholder="Pickup location" value="${s.pickup}" onfocus="showSuggestions('pickup')" oninput="state.rider.pickup=this.value;">
              <div id="pickup-suggestions" class="suggestions hidden">
                ${DELHI_PLACES.slice(0,5).map(p => `<button class="suggestion-item" onclick="state.rider.pickup='${p}';document.getElementById('pickup-input').value='${p}';document.getElementById('pickup-suggestions').classList.add('hidden');">üìç ${p}, Delhi</button>`).join('')}
              </div>
            </div>
            <div style="position:relative;">
              <input class="input-field" id="drop-input" placeholder="Drop location" value="${s.drop}" onfocus="showSuggestions('drop')" oninput="state.rider.drop=this.value;">
              <div id="drop-suggestions" class="suggestions hidden">
                ${DELHI_PLACES.slice(5,10).map(p => `<button class="suggestion-item" onclick="state.rider.drop='${p}';document.getElementById('drop-input').value='${p}';document.getElementById('drop-suggestions').classList.add('hidden');">üìç ${p}, Delhi</button>`).join('')}
              </div>
            </div>
          </div>
        </div>
      </div>
      <button class="btn btn-primary" onclick="if(state.rider.pickup&&state.rider.drop)riderGo('vehicle');" style="${(!s.pickup||!s.drop)?'opacity:0.4;pointer-events:none;':''}">Choose Vehicle ‚Üí</button>`;
  }

 
  else if(s.step === 'vehicle') {
    html = `
      <button class="btn-icon" onclick="riderGo('booking')" style="margin-bottom:16px;">‚Üê</button>
      ${mapHTML(180, s.pickup, s.drop)}
      <div class="flex-between" style="margin:16px 0 12px;">
        <span style="font-weight:600;font-size:16px;">Choose your ride</span>
        <span style="color:var(--gray);font-size:12px;">${distance} km</span>
      </div>
      ${VEHICLES.map(v => {
        const vFare = Math.round(v.base + v.rate * distance);
        const sel = s.selectedVehicle?.id === v.id;
        return `<button class="vehicle-option ${sel?'selected':''}" onclick="state.rider.selectedVehicle=${JSON.stringify(v).replace(/"/g,'&quot;')};state.rider._fare=${vFare};renderRider();">
          <span style="font-size:30px;">${v.icon}</span>
          <div style="flex:1;"><div style="font-weight:600;font-size:14px;">${v.name}</div><div style="color:var(--gray);font-size:11px;">${v.desc} ¬∑ ${v.eta}</div></div>
          <div style="text-align:right;"><div style="font-weight:700;font-size:16px;">‚Çπ${vFare}</div><div style="color:var(--gray);font-size:10px;">‚Çπ${v.rate}/km</div></div>
        </button>`;
      }).join('')}
      <div class="card" style="margin-top:12px;">
        <div style="color:var(--gray);font-size:11px;margin-bottom:8px;">Payment Method</div>
        <div style="display:flex;gap:8px;">
          ${[{id:"cash",l:" Cash"},{id:"upi",l:" UPI"},{id:"card",l:" Card"}].map(p =>
            `<button class="pay-opt ${s.payment===p.id?'active':''}" onclick="state.rider.payment='${p.id}';renderRider();">${p.l}</button>`
          ).join('')}
        </div>
      </div>
      ${s.selectedVehicle ? `<button class="btn btn-primary" style="margin-top:8px;" onclick="riderGo('confirm')">Confirm Ride ‚Äî ‚Çπ${s._fare || fare}</button>` : ''}`;
  }

  
  else if(s.step === 'confirm') {
    html = `
      <div style="text-align:center;padding:30px 0 20px;">
        <div style="width:70px;height:70px;border-radius:50%;margin:0 auto 16px;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;animation:pulse 1.5s infinite;font-size:28px;">üîç</div>
        <h3 style="font-size:20px;margin-bottom:6px;">Finding your driver...</h3>
        <p style="color:var(--gray);font-size:13px;">Usually takes less than 30 seconds</p>
      </div>
      <div class="card" style="margin-top:20px;">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px;">
          <span style="font-size:24px;">${s.selectedVehicle?.icon}</span>
          <div><div style="font-weight:600;">${s.selectedVehicle?.name}</div><div style="color:var(--gray);font-size:12px;">${s._distance} km ¬∑ ${s.selectedVehicle?.eta}</div></div>
          <div style="margin-left:auto;color:var(--cyan);font-weight:700;font-size:18px;">‚Çπ${s._fare}</div>
        </div>
        <div style="border-top:1px solid rgba(136,146,176,0.1);padding-top:12px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;"><span style="color:var(--success);">‚óè</span><span style="color:var(--gray-light);font-size:13px;">${s.pickup}</span></div>
          <div style="display:flex;align-items:center;gap:8px;"><span style="color:var(--danger);">‚óé</span><span style="color:var(--gray-light);font-size:13px;">${s.drop}</span></div>
        </div>
      </div>
      <button class="btn btn-success" style="margin-top:20px;" onclick="state.rider.driverPos=0;riderGo('tracking')">‚úÖ Driver Found ‚Äî Track Ride</button>`;
  }


  else if(s.step === 'tracking') {
    html = `
      ${mapHTML(240, s.pickup, s.drop, true, s.driverPos)}
      <div class="card" style="margin-top:12px;">
        <div class="flex-between" style="margin-bottom:8px;">
          <span style="color:var(--gray);font-size:12px;">Ride Progress</span>
          <span style="color:var(--cyan);font-size:12px;font-weight:600;" id="progress-pct">${s.driverPos}%</span>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width:${s.driverPos}%;background:linear-gradient(90deg,var(--primary),var(--cyan));"></div></div>
      </div>
      <div class="card" style="margin-top:8px;">
        <div style="display:flex;align-items:center;gap:14px;margin-bottom:14px;">
          <div style="width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:22px;">üë§</div>
          <div style="flex:1;">
            <div style="font-weight:600;font-size:15px;">Rajesh Kumar</div>
            <div style="display:flex;align-items:center;gap:4px;"><span style="color:var(--warning);font-size:12px;">‚òÖ 4.8</span><span style="color:var(--gray);font-size:12px;"> ¬∑ DL 01 AB 1234</span></div>
          </div>
          <span style="font-size:28px;">${s.selectedVehicle?.icon||''}</span>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn-sm" style="flex:1;background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.2);color:var(--success);">üìû Call</button>
          <button class="btn-sm" style="flex:1;background:rgba(0,229,255,0.1);border:1px solid rgba(0,229,255,0.2);color:var(--cyan);">üí¨ Chat</button>
          <button class="btn-sm" style="flex:1;background:rgba(255,23,68,0.1);border:1px solid rgba(255,23,68,0.2);color:var(--danger);">üÜò SOS</button>
        </div>
      </div>
      <div class="grid-3" style="margin-top:12px;">
        <div class="card" style="text-align:center;margin:0;"><div style="color:var(--cyan);font-size:20px;font-weight:700;" id="eta-text">${Math.max(1,Math.round((100-s.driverPos)/10))} min</div><div style="color:var(--gray);font-size:11px;">ETA</div></div>
        <div class="card" style="text-align:center;margin:0;"><div style="font-size:20px;font-weight:700;">${s._distance} km</div><div style="color:var(--gray);font-size:11px;">Distance</div></div>
        <div class="card" style="text-align:center;margin:0;"><div style="color:var(--success);font-size:20px;font-weight:700;">‚Çπ${s._fare}</div><div style="color:var(--gray);font-size:11px;">Fare</div></div>
      </div>`;


    clearAllIntervals();
    setTimeout(() => {
      intervals.tracking = setInterval(() => {
        state.rider.driverPos += 2;
        if(state.rider.driverPos >= 100) { clearInterval(intervals.tracking); setTimeout(()=>riderGo('rating'), 500); return; }
        const dm = document.getElementById('driver-marker');
        const pf = document.getElementById('progress-fill');
        const pp = document.getElementById('progress-pct');
        const et = document.getElementById('eta-text');
        if(dm) { dm.style.left = (20+state.rider.driverPos*0.5)+'%'; dm.style.top = (55-state.rider.driverPos*0.2)+'%'; }
        if(pf) pf.style.width = state.rider.driverPos+'%';
        if(pp) pp.textContent = state.rider.driverPos+'%';
        if(et) et.textContent = Math.max(1,Math.round((100-state.rider.driverPos)/10))+' min';
      }, 300);
    }, 100);
  }


  else if(s.step === 'rating') {
    html = `
      <div style="text-align:center;padding:20px 0;">
        <div style="width:80px;height:80px;border-radius:50%;margin:0 auto 20px;background:linear-gradient(135deg,var(--success),#00C853);display:flex;align-items:center;justify-content:center;font-size:36px;">‚úì</div>
        <h2 style="margin-bottom:6px;">Ride Complete! üéâ</h2>
        <p style="color:var(--gray);font-size:14px;margin-bottom:24px;">${s.pickup} ‚Üí ${s.drop}</p>
        <div class="card" style="border-radius:20px;padding:24px;">
          <div style="font-size:36px;font-weight:800;color:var(--cyan);margin-bottom:4px;">‚Çπ${s._fare}</div>
          <div style="color:var(--gray);font-size:13px;margin-bottom:16px;">Paid via ${s.payment.toUpperCase()}</div>
          <div style="display:flex;justify-content:center;gap:24px;padding-top:12px;border-top:1px solid rgba(136,146,176,0.1);">
            <div style="text-align:center;"><div style="font-weight:600;">${s._distance} km</div><div style="color:var(--gray);font-size:11px;">Distance</div></div>
            <div style="text-align:center;"><div style="font-weight:600;">12 min</div><div style="color:var(--gray);font-size:11px;">Duration</div></div>
            <div style="text-align:center;"><div style="font-weight:600;">${s.selectedVehicle?.name}</div><div style="color:var(--gray);font-size:11px;">Vehicle</div></div>
          </div>
        </div>
        <p style="color:var(--gray-light);font-size:15px;margin:24px 0 12px;">Rate your driver</p>
        <div style="display:flex;justify-content:center;gap:8px;margin-bottom:24px;">
          ${[1,2,3,4,5].map(i => `<button class="star-btn ${s.rating>=i?'active':''}" onclick="state.rider.rating=${i};renderRider();" style="font-size:36px;color:${s.rating>=i?'var(--warning)':'var(--gray)'};">${s.rating>=i?'‚òÖ':'‚òÜ'}</button>`).join('')}
        </div>
        <button class="btn btn-primary" onclick="state.rider={step:'home',pickup:'',drop:'',selectedVehicle:null,driverPos:0,rating:0,payment:'cash',_distance:0,_fare:0};riderGo('home');">Done ‚Äî Book Another Ride</button>
      </div>`;
  }

  c.innerHTML = html;
}

function showSuggestions(type) {
  document.getElementById(type+'-suggestions')?.classList.remove('hidden');
  
  const other = type==='pickup'?'drop':'pickup';
  document.getElementById(other+'-suggestions')?.classList.add('hidden');
}


function driverGo(step) {
  clearAllIntervals();
  state.driver.step = step;
  renderDriver();
}

function renderDriver() {
  const c = document.getElementById('driver-content');
  const s = state.driver;
  let html = '';

  
  html += `<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="width:28px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;">
        <svg width="18" height="18" viewBox="0 0 40 40" fill="none"><path d="M5 32L13 8L20 22L27 8L35 32" stroke="white" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <span style="font-size:15px;font-weight:800;letter-spacing:2px;">MOVEO</span>
    </div>
    <div style="display:flex;align-items:center;gap:10px;">
      ${badge(s.isOnline?'online':'offline')}
      <div style="width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:18px;">üë§</div>
    </div>
  </div>`;

 
  if(s.step === 'home') {
    html += `
      <div style="margin-bottom:20px;">
        <h2 style="font-size:22px;font-weight:700;margin-bottom:4px;">${s.isOnline?'You\'re Online üü¢':'Go Online to Start üî¥'}</h2>
        <p style="color:var(--gray);font-size:13px;">${s.isOnline?'Waiting for ride requests...':'Toggle online to receive rides'}</p>
      </div>
      <button class="btn" style="margin-bottom:20px;font-size:18px;padding:20px;background:linear-gradient(135deg,${s.isOnline?'var(--danger),#FF6B6B':'var(--success),#00C853'});color:white;" onclick="state.driver.isOnline=!state.driver.isOnline;${!s.isOnline?"setTimeout(()=>{state.driver.timer=15;driverGo('request');},2000);":""}renderDriver();">
        ‚ö° ${s.isOnline?'GO OFFLINE':'GO ONLINE'}
      </button>
      ${s.isOnline ? mapHTML(160) : ''}
      <div class="grid-2" style="margin-top:${s.isOnline?16:0}px;margin-bottom:16px;">
        ${statCard('','Today','‚Çπ2,450','var(--success)')}
        ${statCard('',"Today's Trips",'8','var(--cyan)')}
        ${statCard('','This Week','‚Çπ14,800','var(--warning)')}
        ${statCard('','This Month','‚Çπ54,200','#7B61FF')}
      </div>
      <div class="card">
        <div style="font-weight:600;margin-bottom:12px;">Today's Trips</div>
        ${[{from:"Saket",to:"CP",fare:320,time:"9:15 AM",rating:5},{from:"Dwarka",to:"Janakpuri",fare:180,time:"10:30 AM",rating:4},{from:"GK",to:"Nehru Place",fare:210,time:"11:45 AM",rating:5}].map((t,i,a) => `
          <div style="display:flex;align-items:center;gap:12px;padding:10px 0;${i<a.length-1?'border-bottom:1px solid rgba(136,146,176,0.06);':''}">
            <div style="width:36px;height:36px;border-radius:10px;background:rgba(0,229,255,0.08);display:flex;align-items:center;justify-content:center;">üß≠</div>
            <div style="flex:1;"><div style="font-size:13px;">${t.from} ‚Üí ${t.to}</div><div style="color:var(--gray);font-size:11px;">${t.time}</div></div>
            <div style="text-align:right;"><div style="color:var(--success);font-weight:600;font-size:14px;">‚Çπ${t.fare}</div><div>${stars(t.rating,9)}</div></div>
          </div>
        `).join('')}
      </div>`;
  }


  else if(s.step === 'request') {
    html += `<div style="text-align:center;">
      <div style="width:100px;height:100px;border-radius:50%;margin:20px auto 24px;position:relative;display:flex;align-items:center;justify-content:center;">
        <svg width="100" height="100" style="position:absolute;transform:rotate(-90deg);"><circle cx="50" cy="50" r="45" stroke="var(--card-bg)" stroke-width="8" fill="none"/><circle cx="50" cy="50" r="45" stroke="var(--cyan)" stroke-width="8" fill="none" stroke-linecap="round" id="timer-circle" stroke-dasharray="283" stroke-dashoffset="${283-(s.timer/15)*283}"/></svg>
        <span style="color:var(--cyan);font-size:28px;font-weight:800;" id="timer-text">${s.timer}s</span>
      </div>
      <h3 style="font-size:20px;margin-bottom:6px;">New Ride Request! üîî</h3>
      <p style="color:var(--gray);font-size:13px;margin-bottom:20px;">Accept before timer expires</p>
      <div class="card" style="text-align:left;">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px;">
          <div style="width:42px;height:42px;border-radius:50%;background:rgba(0,229,255,0.1);display:flex;align-items:center;justify-content:center;font-size:18px;">üë§</div>
          <div><div style="font-weight:600;">Ananya Sharma</div><div style="color:var(--warning);font-size:12px;">‚òÖ 4.9</div></div>
          <div style="margin-left:auto;text-align:right;"><div style="color:var(--success);font-weight:700;font-size:20px;">‚Çπ285</div><div style="color:var(--gray);font-size:11px;">9.3 km</div></div>
        </div>
        <div style="padding:12px;background:var(--card-bg2);border-radius:12px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;"><span style="color:var(--success);">‚óè</span><span style="color:var(--gray-light);font-size:13px;">Connaught Place</span></div>
          <div style="width:1px;height:10px;background:rgba(136,146,176,0.15);margin-left:6px;"></div>
          <div style="display:flex;align-items:center;gap:8px;"><span style="color:var(--danger);">‚óé</span><span style="color:var(--gray-light);font-size:13px;">Hauz Khas Village</span></div>
        </div>
      </div>
      <div style="display:flex;gap:12px;margin-top:16px;">
        <button class="btn btn-danger-outline" style="flex:1;" onclick="state.driver.isOnline=true;driverGo('home');">‚úï Decline</button>
        <button class="btn btn-success" style="flex:2;" onclick="driverGo('navigating')">‚úì Accept Ride</button>
      </div>
    </div>`;

   
    clearAllIntervals();
    setTimeout(() => {
      intervals.request = setInterval(() => {
        state.driver.timer--;
        const tc = document.getElementById('timer-circle');
        const tt = document.getElementById('timer-text');
        if(tc) tc.style.strokeDashoffset = 283 - (state.driver.timer/15)*283;
        if(tt) tt.textContent = state.driver.timer + 's';
        if(state.driver.timer <= 0) { clearInterval(intervals.request); state.driver.isOnline=true; driverGo('home'); }
      }, 1000);
    }, 100);
  }

  
  else if(s.step === 'navigating') {
    html += `
      <div style="background:linear-gradient(135deg,var(--primary),var(--cyan));border-radius:16px;padding:20px;margin-bottom:16px;text-align:center;">
        <div style="font-size:13px;color:rgba(255,255,255,0.7);margin-bottom:4px;">Navigate to pickup</div>
        <div style="font-size:28px;font-weight:800;">Connaught Place</div>
        <div style="font-size:14px;color:rgba(255,255,255,0.8);margin-top:4px;">3 min ¬∑ 1.2 km away</div>
      </div>
      ${mapHTML(240, "Connaught Place", "Hauz Khas", true, 20)}
      <div class="card" style="margin-top:12px;">
        <div style="display:flex;align-items:center;gap:12px;">
          <div style="width:42px;height:42px;border-radius:50%;background:rgba(0,229,255,0.1);display:flex;align-items:center;justify-content:center;font-size:18px;">üë§</div>
          <div style="flex:1;"><div style="font-weight:600;">Ananya Sharma</div><div style="color:var(--gray);font-size:12px;">Rider ¬∑ ‚≠ê 4.9</div></div>
          <button style="width:40px;height:40px;border-radius:50%;background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.2);cursor:pointer;font-size:16px;">üìû</button>
          <button style="width:40px;height:40px;border-radius:50%;background:rgba(0,229,255,0.1);border:1px solid rgba(0,229,255,0.2);cursor:pointer;font-size:16px;">üí¨</button>
        </div>
      </div>
      <button class="btn btn-success" style="margin-top:12px;" onclick="state.driver.tripProgress=0;driverGo('trip')">‚ñ∂ Start Trip ‚Äî Rider Picked Up</button>`;
  }


  else if(s.step === 'trip') {
    html += `
      <div style="background:rgba(255,214,0,0.08);border:1px solid rgba(255,214,0,0.2);border-radius:16px;padding:16px;margin-bottom:16px;text-align:center;">
        <div style="color:var(--warning);font-size:12px;margin-bottom:2px;"> Trip In Progress</div>
        <div style="font-size:22px;font-weight:700;">Hauz Khas Village</div>
        <div class="progress-bar" style="margin-top:10px;"><div class="progress-fill" id="trip-progress-fill" style="width:${s.tripProgress}%;background:linear-gradient(90deg,var(--warning),var(--success));"></div></div>
        <div style="color:var(--gray);font-size:11px;margin-top:6px;" id="trip-progress-text">${s.tripProgress}% complete ¬∑ ${Math.max(1,Math.round((100-s.tripProgress)/12))} min left</div>
      </div>
      ${mapHTML(200, "CP", "Hauz Khas", true, s.tripProgress)}
      <div class="grid-3" style="margin-top:12px;">
        <div class="card" style="text-align:center;margin:0;"><div style="color:var(--cyan);font-size:18px;font-weight:700;">‚Çπ285</div><div style="color:var(--gray);font-size:10px;">Fare</div></div>
        <div class="card" style="text-align:center;margin:0;"><div style="font-size:18px;font-weight:700;">9.3 km</div><div style="color:var(--gray);font-size:10px;">Distance</div></div>
        <div class="card" style="text-align:center;margin:0;"><div style="color:var(--success);font-size:18px;font-weight:700;">‚Çπ228</div><div style="color:var(--gray);font-size:10px;">Your Earning</div></div>
      </div>`;

    clearAllIntervals();
    setTimeout(() => {
      intervals.trip = setInterval(() => {
        state.driver.tripProgress += 3;
        if(state.driver.tripProgress >= 100) { clearInterval(intervals.trip); driverGo('complete'); return; }
        const pf = document.getElementById('trip-progress-fill');
        const pt = document.getElementById('trip-progress-text');
        const dm = document.getElementById('driver-marker');
        if(pf) pf.style.width = state.driver.tripProgress+'%';
        if(pt) pt.textContent = state.driver.tripProgress+'% complete ¬∑ '+Math.max(1,Math.round((100-state.driver.tripProgress)/12))+' min left';
        if(dm) { dm.style.left=(20+state.driver.tripProgress*0.5)+'%'; dm.style.top=(55-state.driver.tripProgress*0.2)+'%'; }
      }, 400);
    }, 100);
  }

 
  else if(s.step === 'complete') {
    html += `
      <div style="text-align:center;padding:20px 0;">
        <div style="width:80px;height:80px;border-radius:50%;margin:0 auto 20px;background:linear-gradient(135deg,var(--success),#00C853);display:flex;align-items:center;justify-content:center;font-size:36px;">‚úì</div>
        <h2 style="margin-bottom:6px;">Trip Complete! üéâ</h2>
        <div class="card" style="border-radius:20px;padding:24px;margin:20px 0;border-color:rgba(0,230,118,0.12);">
          <div style="font-size:14px;color:var(--gray);margin-bottom:4px;">You Earned</div>
          <div style="font-size:40px;font-weight:800;color:var(--success);">‚Çπ228</div>
          <div style="font-size:12px;color:var(--gray);margin-top:4px;">Total fare: ‚Çπ285 ¬∑ Commission: 20%</div>
          <div style="border-top:1px solid rgba(136,146,176,0.1);margin-top:16px;padding-top:16px;display:flex;justify-content:space-around;">
            <div><div style="font-weight:600;">9.3 km</div><div style="color:var(--gray);font-size:11px;">Distance</div></div>
            <div><div style="font-weight:600;">14 min</div><div style="color:var(--gray);font-size:11px;">Duration</div></div>
            <div><div>${stars(5,12)}</div><div style="color:var(--gray);font-size:11px;">Rating</div></div>
          </div>
        </div>
        <button class="btn btn-primary" onclick="state.driver.isOnline=true;driverGo('home');">Continue Driving</button>
      </div>`;
  }

  c.innerHTML = html;
}


const ADMIN_TABS = [
  { id:"overview", icon:"", label:"Overview" },
  { id:"rides", icon:"", label:"Rides" },
  { id:"drivers", icon:"", label:"Drivers" },
  { id:"pricing", icon:"", label:"Pricing" },
  { id:"reports", icon:"", label:"Reports" },
];

function adminGo(tab) {
  state.admin.tab = tab;
  state.admin.selectedDriver = null;
  renderAdmin();
}

function renderAdmin() {
  const tabsEl = document.getElementById('admin-tabs');
  const c = document.getElementById('admin-content');
  const s = state.admin;

 
  tabsEl.innerHTML = ADMIN_TABS.map(t =>
    `<button class="tab-btn ${s.tab===t.id?'active':''}" onclick="adminGo('${t.id}')">${t.icon} ${t.label}</button>`
  ).join('');

  let html = '';

 
  if(s.tab === 'overview') {
    html = `
      <div class="grid-2" style="margin-bottom:16px;">
        ${statCard('',"Today's Rides",'463','var(--cyan)',12)}
        ${statCard('','Revenue','‚Çπ68.4K','var(--success)',8)}
        ${statCard('','Active Drivers','127','#7B61FF',-3)}
        ${statCard('','Active Riders','2,847','var(--warning)',15)}
      </div>
      <div class="card"><div style="font-weight:600;margin-bottom:14px;">Weekly Revenue</div><div class="chart-container"><canvas id="revenue-chart" height="180"></canvas></div></div>
      <div class="card"><div style="font-weight:600;margin-bottom:14px;">Ride Distribution</div><div style="display:flex;align-items:center;">
        <div style="width:50%;"><canvas id="pie-chart" height="140"></canvas></div>
        <div style="flex:1;">
          ${[{n:"Bike",v:35,c:"#00E5FF"},{n:"Mini",v:30,c:"#0A1AFF"},{n:"Sedan",v:25,c:"#7B61FF"},{n:"SUV",v:10,c:"#FF6B6B"}].map(v =>
            `<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;"><div style="width:10px;height:10px;border-radius:3px;background:${v.c};"></div><span style="color:var(--gray-light);font-size:12px;flex:1;">${v.n}</span><span style="font-size:12px;font-weight:600;">${v.v}%</span></div>`
          ).join('')}
        </div>
      </div></div>
      <div class="card">
        <div class="flex-between" style="margin-bottom:12px;">
          <span style="font-weight:600;">Live Rides</span>
          <span class="badge badge-online" style="animation:blink 1.5s infinite;">23 Active</span>
        </div>
        ${mapHTML(150)}
      </div>`;

    setTimeout(() => {
     
      const rc = document.getElementById('revenue-chart');
      if(rc) {
        new Chart(rc, {
          type: 'line',
          data: {
            labels: revenueData.labels,
            datasets: [{
              data: revenueData.revenue,
              borderColor: '#00E5FF',
              backgroundColor: 'rgba(0,229,255,0.08)',
              fill: true, tension: 0.4, pointRadius: 3,
              pointBackgroundColor: '#00E5FF',
            }]
          },
          options: {
            responsive: true, plugins: { legend: { display: false } },
            scales: {
              x: { ticks: { color: '#8892B0', font: { size: 11 } }, grid: { display: false } },
              y: { ticks: { color: '#8892B0', font: { size: 10 } }, grid: { color: 'rgba(0,229,255,0.05)' } }
            }
          }
        });
      }
    
      const pc = document.getElementById('pie-chart');
      if(pc) {
        new Chart(pc, {
          type: 'doughnut',
          data: {
            labels: ['Bike','Mini','Sedan','SUV'],
            datasets: [{ data: [35,30,25,10], backgroundColor: ['#00E5FF','#0A1AFF','#7B61FF','#FF6B6B'], borderWidth: 0 }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, cutout: '60%' }
        });
      }
    }, 50);
  }

  
  else if(s.tab === 'rides') {
    html = `
      <div style="display:flex;gap:8px;margin-bottom:14px;">
        ${["all","completed","in_progress","cancelled"].map(f => `<button class="filter-btn ${f==='all'?'active':''}">${f==='all'?'All':f.replace('_',' ')}</button>`).join('')}
      </div>
      ${MOCK_RIDES.map(r => `
        <div class="ride-card">
          <div class="flex-between" style="margin-bottom:10px;">
            <span style="color:var(--cyan);font-size:12px;font-weight:600;">${r.id}</span>
            ${badge(r.status)}
          </div>
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;"><span style="color:var(--success);font-size:10px;">‚óè</span><span style="color:var(--gray-light);font-size:12px;">${r.from}</span></div>
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;"><span style="color:var(--danger);font-size:10px;">‚óé</span><span style="color:var(--gray-light);font-size:12px;">${r.to}</span></div>
          <div style="display:flex;justify-content:space-between;padding-top:10px;border-top:1px solid rgba(136,146,176,0.06);font-size:11px;">
            <span style="color:var(--gray);"> ${r.rider}</span>
            <span style="color:var(--gray);"> ${r.driver||'‚Äî'}</span>
            <span style="color:var(--gray);">${r.vehicle} ¬∑ ${r.distance}</span>
            <span style="color:var(--success);font-weight:600;">‚Çπ${r.fare}</span>
          </div>
        </div>
      `).join('')}`;
  }

 
  else if(s.tab === 'drivers') {
    if(s.selectedDriver) {
      const d = s.selectedDriver;
      html = `
        <button style="display:flex;align-items:center;gap:6px;background:none;border:none;color:var(--cyan);cursor:pointer;margin-bottom:16px;font-size:13px;" onclick="state.admin.selectedDriver=null;renderAdmin();">‚Üê Back to Drivers</button>
        <div class="card" style="padding:20px;">
          <div style="display:flex;align-items:center;gap:14px;margin-bottom:16px;">
            <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:24px;">üë§</div>
            <div style="flex:1;"><div style="font-weight:700;font-size:18px;">${d.name}</div><div style="color:var(--gray);font-size:12px;">${d.phone}</div></div>
            ${badge(d.status)}
          </div>
          <div class="grid-2" style="margin-bottom:16px;">
            <div style="background:var(--card-bg2);border-radius:12px;padding:12px;"><div style="color:var(--gray);font-size:11px;">Rating</div><div style="color:var(--warning);font-size:20px;font-weight:700;">‚≠ê ${d.rating}</div></div>
            <div style="background:var(--card-bg2);border-radius:12px;padding:12px;"><div style="color:var(--gray);font-size:11px;">Total Rides</div><div style="font-size:20px;font-weight:700;">${d.rides}</div></div>
            <div style="background:var(--card-bg2);border-radius:12px;padding:12px;"><div style="color:var(--gray);font-size:11px;">Earnings</div><div style="color:var(--success);font-size:20px;font-weight:700;">‚Çπ${d.earnings.toLocaleString()}</div></div>
            <div style="background:var(--card-bg2);border-radius:12px;padding:12px;"><div style="color:var(--gray);font-size:11px;">Vehicle</div><div style="font-size:14px;font-weight:600;">${d.vehicle}</div><div style="color:var(--gray);font-size:11px;">${d.plate}</div></div>
          </div>
          <div style="display:flex;gap:8px;">
            <button class="btn-sm" style="flex:1;background:${d.verified?'rgba(0,230,118,0.1)':'rgba(255,214,0,0.1)'};border:1px solid ${d.verified?'rgba(0,230,118,0.2)':'rgba(255,214,0,0.2)'};color:${d.verified?'var(--success)':'var(--warning)'};">${d.verified?'‚úì Verified':'‚ö† Verify Driver'}</button>
            <button class="btn-sm" style="flex:1;background:rgba(255,23,68,0.1);border:1px solid rgba(255,23,68,0.2);color:var(--danger);">Block Driver</button>
          </div>
        </div>`;
    } else {
      html = `<div class="flex-between" style="margin-bottom:14px;"><span style="font-weight:600;font-size:16px;">All Drivers (${MOCK_DRIVERS.length})</span></div>`;
      MOCK_DRIVERS.forEach(d => {
        html += `<button class="driver-item" onclick='state.admin.selectedDriver=${JSON.stringify(d).replace(/'/g,"\\'")}; renderAdmin();'>
          <div style="width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,rgba(10,26,255,0.7),rgba(0,229,255,0.7));display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:16px;">üë§</div>
          <div style="flex:1;min-width:0;"><div style="font-weight:600;font-size:13px;">${d.name}</div><div style="color:var(--gray);font-size:11px;">${d.vehicle} ¬∑ ‚≠ê ${d.rating} ¬∑ ${d.rides} rides</div></div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
            ${badge(d.status)}
            ${!d.verified?badge('pending'):''}
          </div>
        </button>`;
      });
    }
  }

 
  else if(s.tab === 'pricing') {
    const p = s.pricing;
    html = `<h3 style="font-size:18px;font-weight:700;margin-bottom:16px;">Pricing Rules</h3>
    <div class="card">
      ${[{l:"Base Fare",k:"baseFare",u:"‚Çπ",min:10,max:100},{l:"Per Kilometer",k:"perKm",u:"‚Çπ/km",min:5,max:50},{l:"Per Minute",k:"perMin",u:"‚Çπ/min",min:1,max:10}].map(item => `
        <div style="margin-bottom:18px;">
          <div class="flex-between" style="margin-bottom:8px;">
            <span style="color:var(--gray-light);font-size:13px;">${item.l}</span>
            <span style="color:var(--cyan);font-weight:700;font-size:16px;">${item.u==='‚Çπ'?'‚Çπ':''}${p[item.k]}${item.u!=='‚Çπ'?' '+item.u:''}</span>
          </div>
          <div style="display:flex;align-items:center;gap:10px;">
            <button class="btn-icon" style="width:32px;height:32px;border:1px solid rgba(0,229,255,0.12);" onclick="state.admin.pricing.${item.k}=Math.max(${item.min},state.admin.pricing.${item.k}-1);renderAdmin();">‚àí</button>
            <div style="flex:1;height:6px;background:var(--card-bg2);border-radius:3px;overflow:hidden;">
              <div style="height:100%;width:${((p[item.k]-item.min)/(item.max-item.min))*100}%;background:linear-gradient(90deg,var(--primary),var(--cyan));border-radius:3px;"></div>
            </div>
            <button class="btn-icon" style="width:32px;height:32px;border:1px solid rgba(0,229,255,0.12);" onclick="state.admin.pricing.${item.k}=Math.min(${item.max},state.admin.pricing.${item.k}+1);renderAdmin();">+</button>
          </div>
        </div>
      `).join('')}
    </div>
    <div class="card" style="border-color:rgba(255,214,0,0.12);">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:14px;">
        <span></span><span style="font-weight:600;">Surge Pricing</span>
      </div>
      <div style="display:flex;gap:8px;">
        ${[1.0,1.25,1.5,1.75,2.0].map(sv => `<button class="surge-btn ${p.surge===sv?'active':''}" onclick="state.admin.pricing.surge=${sv};renderAdmin();">${sv}x</button>`).join('')}
      </div>
    </div>
    <div class="card">
      <div style="font-weight:600;margin-bottom:12px;">Fare Preview (10 km, 20 min)</div>
      <div class="grid-2">
        ${VEHICLES.map(v => {
          const est = Math.round((p.baseFare + p.perKm*10 + p.perMin*20) * p.surge * (v.rate/12));
          return `<div style="background:var(--card-bg2);border-radius:12px;padding:12px;display:flex;align-items:center;gap:10px;"><span style="font-size:22px;">${v.icon}</span><div><div style="font-size:12px;font-weight:600;">${v.name}</div><div style="color:var(--cyan);font-size:16px;font-weight:700;">‚Çπ${est}</div></div></div>`;
        }).join('')}
      </div>
    </div>`;
  }

  // REPORTS
  else if(s.tab === 'reports') {
    html = `<h3 style="font-size:18px;font-weight:700;margin-bottom:16px;">Analytics & Reports</h3>
    <div class="card"><div style="font-weight:600;margin-bottom:12px;">Rides by Hour (Today)</div><div class="chart-container"><canvas id="hourly-chart" height="160"></canvas></div></div>
    <div class="card"><div style="font-weight:600;margin-bottom:12px;">Revenue vs Rides (Weekly)</div><div class="chart-container"><canvas id="weekly-chart" height="160"></canvas></div>
      <div style="display:flex;justify-content:center;gap:20px;margin-top:8px;">
        <div style="display:flex;align-items:center;gap:6px;"><div style="width:12px;height:3px;background:var(--cyan);border-radius:2px;"></div><span style="color:var(--gray);font-size:11px;">Revenue</span></div>
        <div style="display:flex;align-items:center;gap:6px;"><div style="width:12px;height:3px;background:var(--warning);border-radius:2px;"></div><span style="color:var(--gray);font-size:11px;">Rides</span></div>
      </div>
    </div>
    <div class="grid-2">
      ${statCard('','Avg Fare','‚Çπ247','var(--cyan)')}
      ${statCard('','Avg Duration','18 min','var(--warning)')}
      ${statCard('','Avg Rating','4.6 ‚≠ê','var(--warning)')}
      ${statCard('','Cancel Rate','8.2%','var(--danger)')}
    </div>`;

    setTimeout(() => {
      const hourlyD = Array.from({length:24}, (_,i) => Math.floor(Math.random()*60)+(i>=8&&i<=10?40:i>=17&&i<=20?50:10));
      const hc = document.getElementById('hourly-chart');
      if(hc) {
        new Chart(hc, {
          type: 'bar',
          data: {
            labels: Array.from({length:24},(_,i)=>i+':00'),
            datasets: [{data:hourlyD, backgroundColor:'#00E5FF', borderRadius:4}]
          },
          options: {
            responsive:true, plugins:{legend:{display:false}},
            scales: {
              x:{ticks:{color:'#8892B0',font:{size:9},maxTicksLimit:8},grid:{display:false}},
              y:{ticks:{color:'#8892B0',font:{size:10}},grid:{color:'rgba(0,229,255,0.05)'}}
            }
          }
        });
      }
      const wc = document.getElementById('weekly-chart');
      if(wc) {
        new Chart(wc, {
          type: 'line',
          data: {
            labels: revenueData.labels,
            datasets: [
              {data:revenueData.revenue, borderColor:'#00E5FF', backgroundColor:'transparent', tension:0.4, pointRadius:3, pointBackgroundColor:'#00E5FF', yAxisID:'y'},
              {data:revenueData.rides, borderColor:'#FFD600', backgroundColor:'transparent', tension:0.4, pointRadius:3, pointBackgroundColor:'#FFD600', yAxisID:'y1'},
            ]
          },
          options: {
            responsive:true, plugins:{legend:{display:false}},
            scales: {
              x:{ticks:{color:'#8892B0',font:{size:11}},grid:{display:false}},
              y:{position:'left',ticks:{color:'#8892B0',font:{size:10}},grid:{color:'rgba(0,229,255,0.05)'}},
              y1:{position:'right',ticks:{color:'#8892B0',font:{size:10}},grid:{display:false}}
            }
          }
        });
      }
    }, 50);
  }

  c.innerHTML = html;
}


document.addEventListener('click', (e) => {
  if(!e.target.closest('#pickup-input') && !e.target.closest('#pickup-suggestions'))
    document.getElementById('pickup-suggestions')?.classList.add('hidden');
  if(!e.target.closest('#drop-input') && !e.target.closest('#drop-suggestions'))
    document.getElementById('drop-suggestions')?.classList.add('hidden');
});
</script>
</body>
</html>
